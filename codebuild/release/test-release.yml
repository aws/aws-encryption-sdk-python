version: 0.2

env:
  secrets-manager:
    TWINE_USERNAME: TestPyPiAPIToken:username 
    TWINE_PASSWORD: TestPyPiAPIToken:password

phases:
  install:
    runtime-versions:
      python: latest
  build:
    commands:
      - pip install tox
      - git fetch origin $COMMIT_ID:$COMMIT_ID --depth=1
      - git checkout $COMMIT_ID
      - tox -e park
      - tox -e test-release


batch:
  fast-fail: false
  build-list:
    - identifier: test_release
