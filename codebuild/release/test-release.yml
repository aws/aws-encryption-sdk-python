version: 0.2

env:
  variables:
    BRANCH: "mainline-1.x"
  secrets-manager:
    TWINE_USERNAME: TestPyPiCryptoTools:username 
    TWINE_PASSWORD: TestPyPiCryptoTools:password

phases:
  install:
    runtime-versions:
      python: latest
  build:
    commands:
      - pip install tox
      - git fetch origin $BRANCH:$BRANCH --depth=1
      - git checkout $COMMIT_ID
      - tox -e park
      - tox -e test-release


batch:
  fast-fail: false
  build-list:
    - identifier: test_release
