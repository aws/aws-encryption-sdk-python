name: AWS CodeBuild Batch Workflow

on:
  pull_request:
  push:
  # Run once a day
  schedule:
    - cron: "0 0 * * *"

permissions:
  id-token: write
  contents: read

jobs:
  # Python 3.8 jobs
  py38_integ:
    name: Python 3.8 Integration Tests
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py38/integ.yml
          image-override: aws/codebuild/standard:5.0

  py38_examples:
    name: Python 3.8 Examples
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py38/examples.yml
          image-override: aws/codebuild/standard:5.0

  py38_decrypt_dafny_esdk_vectors:
    name: Python 3.8 Decrypt Dafny ESDK Vectors
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py38/decrypt_dafny_esdk_vectors.yml
          image-override: aws/codebuild/standard:5.0

  py38_decrypt_net_401_vectors:
    name: Python 3.8 Decrypt .NET 4.0.1 Vectors
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py38/decrypt_net_401_vectors.yml
          image-override: aws/codebuild/standard:5.0

  py38_encrypt_masterkey:
    name: Python 3.8 Encrypt Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py38/encrypt_masterkey.yml
          image-override: aws/codebuild/standard:5.0

  py38_generate_decrypt_vectors_masterkey:
    name: Python 3.8 Generate Decrypt Vectors Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py38/generate_decrypt_vectors_masterkey.yml
          image-override: aws/codebuild/standard:5.0

  py38_decrypt_masterkey_with_masterkey:
    name: Python 3.8 Decrypt Masterkey with Masterkey
    needs: py38_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py38/decrypt_masterkey_with_masterkey.yml
          image-override: aws/codebuild/standard:5.0

  py38_decrypt_masterkey_with_js:
    name: Python 3.8 Decrypt Masterkey with JS
    needs: py38_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py38/decrypt_masterkey_with_js.yml
          image-override: aws/codebuild/standard:5.0

  # Python 3.9 jobs
  py39_integ:
    name: Python 3.9 Integration Tests
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py39/integ.yml
          image-override: aws/codebuild/standard:5.0

  py39_examples:
    name: Python 3.9 Examples
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py39/examples.yml
          image-override: aws/codebuild/standard:5.0

  py39_decrypt_dafny_esdk_vectors:
    name: Python 3.9 Decrypt Dafny ESDK Vectors
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py39/decrypt_dafny_esdk_vectors.yml
          image-override: aws/codebuild/standard:5.0

  py39_decrypt_net_401_vectors:
    name: Python 3.9 Decrypt .NET 4.0.1 Vectors
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py39/decrypt_net_401_vectors.yml
          image-override: aws/codebuild/standard:5.0

  py39_encrypt_masterkey:
    name: Python 3.9 Encrypt Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py39/encrypt_masterkey.yml
          image-override: aws/codebuild/standard:5.0

  py39_generate_decrypt_vectors_masterkey:
    name: Python 3.9 Generate Decrypt Vectors Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py39/generate_decrypt_vectors_masterkey.yml
          image-override: aws/codebuild/standard:5.0

  py39_decrypt_masterkey_with_masterkey:
    name: Python 3.9 Decrypt Masterkey with Masterkey
    needs: py39_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py39/decrypt_masterkey_with_masterkey.yml
          image-override: aws/codebuild/standard:5.0

  py39_decrypt_masterkey_with_js:
    name: Python 3.9 Decrypt Masterkey with JS
    needs: py39_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py39/decrypt_masterkey_with_js.yml
          image-override: aws/codebuild/standard:5.0

  # Python 3.10 jobs
  py310_integ:
    name: Python 3.10 Integration Tests
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py310/integ.yml
          image-override: aws/codebuild/standard:6.0

  py310_examples:
    name: Python 3.10 Examples
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py310/examples.yml
          image-override: aws/codebuild/standard:6.0

  py310_decrypt_dafny_esdk_vectors:
    name: Python 3.10 Decrypt Dafny ESDK Vectors
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py310/decrypt_dafny_esdk_vectors.yml
          image-override: aws/codebuild/standard:6.0

  py310_decrypt_net_401_vectors:
    name: Python 3.10 Decrypt .NET 4.0.1 Vectors
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py310/decrypt_net_401_vectors.yml
          image-override: aws/codebuild/standard:6.0

  py310_encrypt_masterkey:
    name: Python 3.10 Encrypt Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py310/encrypt_masterkey.yml
          image-override: aws/codebuild/standard:6.0

  py310_generate_decrypt_vectors_masterkey:
    name: Python 3.10 Generate Decrypt Vectors Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py310/generate_decrypt_vectors_masterkey.yml
          image-override: aws/codebuild/standard:6.0

  py310_decrypt_masterkey_with_masterkey:
    name: Python 3.10 Decrypt Masterkey with Masterkey
    needs: py310_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py310/decrypt_masterkey_with_masterkey.yml
          image-override: aws/codebuild/standard:6.0

  py310_decrypt_masterkey_with_js:
    name: Python 3.10 Decrypt Masterkey with JS
    needs: py310_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py310/decrypt_masterkey_with_js.yml
          image-override: aws/codebuild/standard:6.0

  # Python 3.11 jobs
  py311_integ:
    name: Python 3.11 Integration Tests
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/integ.yml
          image-override: aws/codebuild/standard:7.0

  py311_integ_mpl:
    name: Python 3.11 Integration MPL
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/integ_mpl.yml
          image-override: aws/codebuild/standard:7.0

  py311_performance_tests_mpl:
    name: Python 3.11 Performance Tests MPL
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/performance_tests_mpl.yml
          image-override: aws/codebuild/standard:7.0

  py311_examples:
    name: Python 3.11 Examples
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/examples.yml
          image-override: aws/codebuild/standard:7.0

  py311_examples_mpl:
    name: Python 3.11 Examples MPL
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/examples_mpl.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_dafny_esdk_vectors_masterkey:
    name: Python 3.11 Decrypt Dafny ESDK Vectors Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_dafny_esdk_vectors_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_dafny_esdk_vectors_keyrings:
    name: Python 3.11 Decrypt Dafny ESDK Vectors Keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_dafny_esdk_vectors_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_net_401_vectors_masterkey:
    name: Python 3.11 Decrypt .NET 4.0.1 Vectors Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_net_401_vectors_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_net_401_vectors_keyrings:
    name: Python 3.11 Decrypt .NET 4.0.1 Vectors Keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_net_401_vectors_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py311_encrypt_masterkey:
    name: Python 3.11 Encrypt Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/encrypt_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py311_encrypt_keyrings:
    name: Python 3.11 Encrypt Keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/encrypt_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py311_generate_decrypt_vectors_masterkey:
    name: Python 3.11 Generate Decrypt Vectors Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/generate_decrypt_vectors_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_masterkey_with_masterkey:
    name: Python 3.11 Decrypt Masterkey with Masterkey
    needs: py311_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_masterkey_with_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_masterkey_with_keyrings:
    name: Python 3.11 Decrypt Masterkey with Keyrings
    needs: py311_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_masterkey_with_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_masterkey_with_js:
    name: Python 3.11 Decrypt Masterkey with JS
    needs: py311_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_masterkey_with_js.yml
          image-override: aws/codebuild/standard:7.0

  py311_generate_decrypt_vectors_keyrings:
    name: Python 3.11 Generate Decrypt Vectors Keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/generate_decrypt_vectors_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_keyrings_with_masterkey:
    name: Python 3.11 Decrypt Keyrings with Masterkey
    needs: py311_generate_decrypt_vectors_keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_keyrings_with_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_keyrings_with_keyrings:
    name: Python 3.11 Decrypt Keyrings with Keyrings
    needs: py311_generate_decrypt_vectors_keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_keyrings_with_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_keyrings_with_js:
    name: Python 3.11 Decrypt Keyrings with JS
    needs: py311_generate_decrypt_vectors_keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_keyrings_with_js.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_golden_manifest_with_keyrings:
    name: Python 3.11 Decrypt Golden Manifest with Keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_golden_manifest_with_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py311_decrypt_golden_manifest_with_masterkey:
    name: Python 3.11 Decrypt Golden Manifest with Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py311/decrypt_golden_manifest_with_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  # Python 3.12 jobs
  py312_integ:
    name: Python 3.12 Integration Tests
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/integ.yml
          image-override: aws/codebuild/standard:7.0

  py312_integ_mpl:
    name: Python 3.12 Integration MPL
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/integ_mpl.yml
          image-override: aws/codebuild/standard:7.0

  py312_performance_tests_mpl:
    name: Python 3.12 Performance Tests MPL
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/performance_tests_mpl.yml
          image-override: aws/codebuild/standard:7.0

  py312_examples:
    name: Python 3.12 Examples
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/examples.yml
          image-override: aws/codebuild/standard:7.0

  py312_examples_mpl:
    name: Python 3.12 Examples MPL
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/examples_mpl.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_dafny_esdk_vectors_masterkey:
    name: Python 3.12 Decrypt Dafny ESDK Vectors Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_dafny_esdk_vectors_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_dafny_esdk_vectors_keyrings:
    name: Python 3.12 Decrypt Dafny ESDK Vectors Keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_dafny_esdk_vectors_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_net_401_vectors_masterkey:
    name: Python 3.12 Decrypt .NET 4.0.1 Vectors Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_net_401_vectors_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_net_401_vectors_keyrings:
    name: Python 3.12 Decrypt .NET 4.0.1 Vectors Keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_net_401_vectors_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py312_encrypt_masterkey:
    name: Python 3.12 Encrypt Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/encrypt_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py312_encrypt_keyrings:
    name: Python 3.12 Encrypt Keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/encrypt_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py312_generate_decrypt_vectors_masterkey:
    name: Python 3.12 Generate Decrypt Vectors Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/generate_decrypt_vectors_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_masterkey_with_masterkey:
    name: Python 3.12 Decrypt Masterkey with Masterkey
    needs: py312_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_masterkey_with_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_masterkey_with_keyrings:
    name: Python 3.12 Decrypt Masterkey with Keyrings
    needs: py312_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_masterkey_with_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_masterkey_with_js:
    name: Python 3.12 Decrypt Masterkey with JS
    needs: py312_generate_decrypt_vectors_masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_masterkey_with_js.yml
          image-override: aws/codebuild/standard:7.0

  py312_generate_decrypt_vectors_keyrings:
    name: Python 3.12 Generate Decrypt Vectors Keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/generate_decrypt_vectors_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_keyrings_with_masterkey:
    name: Python 3.12 Decrypt Keyrings with Masterkey
    needs: py312_generate_decrypt_vectors_keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_keyrings_with_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_keyrings_with_keyrings:
    name: Python 3.12 Decrypt Keyrings with Keyrings
    needs: py312_generate_decrypt_vectors_keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_keyrings_with_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_keyrings_with_js:
    name: Python 3.12 Decrypt Keyrings with JS
    needs: py312_generate_decrypt_vectors_keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_keyrings_with_js.yml
          image-override: aws/codebuild/standard:7.0

  py312_generate_hkeyring_decrypt_vectors:
    name: Python 3.12 Generate HKeyring Decrypt Vectors
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/generate_hkeyring_decrypt_vectors.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_hkeyring_with_masterkey:
    name: Python 3.12 Decrypt HKeyring with Masterkey
    needs: py312_generate_hkeyring_decrypt_vectors
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_hkeyring_with_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_hkeyring_with_keyrings:
    name: Python 3.12 Decrypt HKeyring with Keyrings
    needs: py312_generate_hkeyring_decrypt_vectors
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_hkeyring_with_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_hkeyring_with_net:
    name: Python 3.12 Decrypt HKeyring with .NET
    needs: py312_generate_hkeyring_decrypt_vectors
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_hkeyring_with_net.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_golden_manifest_with_keyrings:
    name: Python 3.12 Decrypt Golden Manifest with Keyrings
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_golden_manifest_with_keyrings.yml
          image-override: aws/codebuild/standard:7.0

  py312_decrypt_golden_manifest_with_masterkey:
    name: Python 3.12 Decrypt Golden Manifest with Masterkey
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/py312/decrypt_golden_manifest_with_masterkey.yml
          image-override: aws/codebuild/standard:7.0

  # Code Coverage and Compliance jobs
  code_coverage:
    name: Code Coverage
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/coverage/coverage.yml

  code_coverage_mpl:
    name: Code Coverage MPL
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/coverage/coverage_mpl.yml
          image-override: aws/codebuild/standard:7.0

  compliance:
    name: Compliance
    runs-on: ubuntu-latest
    steps:
      - name: Configure AWS Credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          role-to-assume: ${{ secrets.CI_AWS_ROLE_ARN }}
          aws-region: us-west-2
          role-duration-seconds: 7200
      - name: Run CodeBuild
        uses: aws-actions/aws-codebuild-run-build@v1
        timeout-minutes: 120
        with:
          project-name: python-esdk
          buildspec-override: codebuild/compliance/compliance.yml
