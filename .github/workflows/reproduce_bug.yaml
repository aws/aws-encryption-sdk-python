name: ðŸ› Reproduce Python 3.14.2 x86 Bug

on:
  push:
    paths:
      - '.github/workflows/reproduce_bug.yaml'

permissions:
  contents: read

jobs:
  reproduce:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v4
      
      - uses: actions/setup-python@v5
        with:
          python-version: "3.14"
          architecture: x86
      
      - name: Create standalone test file
        run: |
          @"
          import pytest
          
          @pytest.mark.parametrize('key1,key2', [
              ('\U00010002abc', 'abc\u79d8\u5bc6\u4ee3\u7801'),
              ('test1', 'test2'),
              ('\U00010002', '\u79d8\u5bc6'),
          ])
          def test_unicode_params(key1, key2):
              assert len(key1) > 0
              assert len(key2) > 0
          "@ | Out-File -FilePath test_standalone.py -Encoding utf8
      
      - name: Install pytest
        run: pip install pytest==8.0.0
      
      - name: Run standalone test (will crash)
        run: pytest test_standalone.py -vv
